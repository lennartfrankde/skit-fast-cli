#!/bin/bash

# Local Development Setup Script
# Generated by skit-fast-cli

echo "üöÄ Setting up local development environment..."

# Check if Docker is installed
if ! command -v docker &> /dev/null; then
    echo "‚ùå Docker is not installed. Please install Docker to run local services."
    echo "   Download from: https://www.docker.com/products/docker-desktop"
    exit 1
fi

# Check if Docker is running
if ! docker info &> /dev/null; then
    echo "‚ùå Docker is not running. Please start Docker and try again."
    exit 1
fi

# Check if Docker Compose is available
if ! command -v docker-compose &> /dev/null && ! docker compose version &> /dev/null; then
    echo "‚ùå Docker Compose is not installed. Please install Docker Compose."
    exit 1
fi

# Install dependencies if not already done
if [ ! -d "node_modules" ]; then
    echo "üì¶ Installing npm dependencies..."
    npm install
fi

# Start local services
echo "üì¶ Starting local services..."
npm run services:start

# Wait a moment for services to start
echo "‚è≥ Waiting for services to initialize..."
sleep 8

echo "‚úÖ Local development environment is ready!"
echo ""
echo "üåê Available services:"
echo "   ‚Ä¢ SvelteKit app: http://localhost:5173 (run 'npm run dev')"
echo "   ‚Ä¢ PocketBase: http://localhost:8090 (if selected)"
echo "   ‚Ä¢ MongoDB: localhost:27017 (if selected)"
echo "   ‚Ä¢ Redis: localhost:6379 (if selected)"
echo "   ‚Ä¢ LiteLLM: http://localhost:4000 (if selected)"
echo "   ‚Ä¢ Qdrant: http://localhost:6333 (if selected)"
echo ""
echo "üìã Next steps:"
echo "   1. Run 'npm run dev' to start the SvelteKit development server"
echo "   2. Open http://localhost:5173 in your browser"
echo "   3. Run 'npm run services:stop' when done developing"
echo ""
echo "üîç Additional commands:"
echo "   ‚Ä¢ View service logs: npm run services:logs"
echo "   ‚Ä¢ Stop all services: npm run dev:teardown"
echo "   ‚Ä¢ Check .env file for connection details"